# üè† –õ–æ–∫–∞–ª—å–Ω–∏–π –ó–∞–ø—É—Å–∫ CRM "–®–∫–æ–ª–∞ –ñ–∏—Ç—Ç—è"

## üìã **–Ü–ù–°–¢–†–£–ö–¶–Ü–Ø –î–õ–Ø –ó–ê–ü–£–°–ö–£**

---

## ‚úÖ **–ü–ï–†–ï–î–£–ú–û–í–ò**

### 1Ô∏è‚É£ –õ–æ–∫–∞–ª—å–Ω–∞ –ë–∞–∑–∞ –î–∞–Ω–∏—Ö –ú–∞—î –ü—Ä–∞—Ü—é–≤–∞—Ç–∏

–ü–µ—Ä–µ–≤—ñ—Ä —â–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä `school-db` –∑–∞–ø—É—â–µ–Ω–∏–π:

```bash
docker ps | grep school-db
```

–ü–æ–≤–∏–Ω–Ω–æ –ø–æ–∫–∞–∑–∞—Ç–∏:
```
d8bbfa98a11a   postgres:15-alpine   ...   Up 2 hours   0.0.0.0:5432->5432/tcp   school-db
```

–Ø–∫—â–æ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö –ù–ï –∑–∞–ø—É—â–µ–Ω–∞:
```bash
docker start school-db
```

### 2Ô∏è‚É£ –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è –©–æ –ë–∞–∑–∞ –ú—ñ—Å—Ç–∏—Ç—å –î–∞–Ω—ñ

```bash
docker exec school-db psql -U school_user -d school_db -c "\dt"
```

–ü–æ–≤–∏–Ω–Ω–æ –ø–æ–∫–∞–∑–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü—å: `students`, `teachers`, `clubs`, `schedules`, —Ç–æ—â–æ.

---

## üöÄ **–ó–ê–ü–£–°–ö –î–û–î–ê–¢–ö–£**

### –ü—Ä–æ—Å—Ç–∏–π –°–ø–æ—Å—ñ–± (–°–∫—Ä–∏–ø—Ç):

```bash
./start_local.sh
```

### –†—É—á–Ω–∏–π –°–ø–æ—Å—ñ–± (Docker Compose):

```bash
# 1. –ó–±—ñ—Ä–∫–∞ –æ–±—Ä–∞–∑—ñ–≤
docker-compose -f docker-compose.local.yml build

# 2. –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤
docker-compose -f docker-compose.local.yml up -d

# 3. –ü–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤
docker-compose -f docker-compose.local.yml logs -f
```

---

## üåê **–î–û–°–¢–£–ü –î–û –î–û–î–ê–¢–ö–£**

–ü—ñ—Å–ª—è –∑–∞–ø—É—Å–∫—É:

- üåê **–í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å:** http://localhost:8000/admin/
- üìö **API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è:** http://localhost:8000/docs
- ‚ù§Ô∏è **Health Check:** http://localhost:8000/health
- üì± **WebApp (Telegram):** http://localhost:3001

**–õ–æ–≥—ñ–Ω –≤ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å:**
- Email: `admin@school.local`
- –ü–∞—Ä–æ–ª—å: `admin123`

---

## üõë **–ó–£–ü–ò–ù–ö–ê –î–û–î–ê–¢–ö–£**

### –ü—Ä–æ—Å—Ç–∏–π –°–ø–æ—Å—ñ–± (–°–∫—Ä–∏–ø—Ç):

```bash
./stop_local.sh
```

### –†—É—á–Ω–∏–π –°–ø–æ—Å—ñ–±:

```bash
docker-compose -f docker-compose.local.yml down
```

**‚ö†Ô∏è –í–ê–ñ–õ–ò–í–û:** –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö `school-db` –ù–ï –±—É–¥–µ –∑—É–ø–∏–Ω–µ–Ω–∞ (–≤–æ–Ω–∞ –ø—Ä–∞—Ü—é—î –æ–∫—Ä–µ–º–æ —ñ –º—ñ—Å—Ç–∏—Ç—å —Ü—ñ–Ω–Ω—ñ –¥–∞–Ω—ñ).

---

## üîç **–ü–ï–†–ï–í–Ü–†–ö–ê –°–¢–ê–ù–£**

### –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –∑–∞–ø—É—â–µ–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏:

```bash
docker ps
```

–ü–æ–≤–∏–Ω–Ω–æ –±—É—Ç–∏ **3 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏**:
- `school-db` (PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–∏—Ö - –¢–ê –©–û –í–ñ–ï –Ü–°–ù–£–í–ê–õ–ê)
- `new--_webapp_1` (FastAPI –¥–æ–¥–∞—Ç–æ–∫)
- `new--_dispatcher_1` (Telegram –±–æ—Ç)

### –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ª–æ–≥–∏:

```bash
# –í—Å—ñ –ª–æ–≥–∏
docker-compose -f docker-compose.local.yml logs -f

# –¢—ñ–ª—å–∫–∏ webapp
docker-compose -f docker-compose.local.yml logs -f webapp

# –¢—ñ–ª—å–∫–∏ dispatcher (Telegram –±–æ—Ç)
docker-compose -f docker-compose.local.yml logs -f dispatcher
```

---

## üîó **–Ø–ö –¶–ï –ü–†–ê–¶–Æ–Ñ**

### –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –î–æ –ë–∞–∑–∏ –î–∞–Ω–∏—Ö:

```
[webapp –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä]  ‚îÄ‚îê
                     ‚îú‚îÄ‚Üí host.docker.internal:5432 ‚îÄ‚Üí [school-db –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä]
[dispatcher –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä]‚îÄ‚îò                               (—ñ—Å–Ω—É—é—á–∞ –ë–î)
```

**–ö–ª—é—á–æ–≤—ñ –º–æ–º–µ–Ω—Ç–∏:**
- ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **–Ü–°–ù–£–Æ–ß–ê** –±–∞–∑–∞ –¥–∞–Ω–∏—Ö `school-db`
- ‚úÖ **–ù–Ü–Ø–ö–ò–• –ó–ú–Ü–ù** –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö –Ω–µ —Ä–æ–±–∏—Ç—å—Å—è
- ‚úÖ –î–æ–¥–∞—Ç–æ–∫ **–¢–Ü–õ–¨–ö–ò –ß–ò–¢–ê–Ñ –¢–ê –ó–ê–ü–ò–°–£–Ñ** –¥–∞–Ω—ñ (—è–∫ —ñ –º–∞—î –±—É—Ç–∏)
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –ø—Ä–∞—Ü—é—î **–û–ö–†–ï–ú–û** –≤—ñ–¥ –¥–æ–¥–∞—Ç–∫—É
- ‚úÖ –ó—É–ø–∏–Ω–∫–∞ –¥–æ–¥–∞—Ç–∫—É **–ù–ï –ó–£–ü–ò–ù–Ø–Ñ** –±–∞–∑—É –¥–∞–Ω–∏—Ö

---

## üìä **–ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø**

### –ó–º—ñ–Ω–Ω—ñ –û—Ç–æ—á–µ–Ω–Ω—è (–≤–±—É–¥–æ–≤–∞–Ω—ñ –≤ docker-compose.local.yml):

```yaml
POSTGRES_HOST=host.docker.internal  # –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –ª–æ–∫–∞–ª—å–Ω–æ—ó –ë–î
POSTGRES_PORT=5432
POSTGRES_DB=school_db
POSTGRES_USER=school_user
POSTGRES_PASSWORD=school_password_123

TELEGRAM_BOT_TOKEN=your_bot_token_from_botfather
WEBAPP_URL=http://localhost:3001
```

**‚ö†Ô∏è –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–º—ñ–Ω–∏—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:**
–†–µ–¥–∞–≥—É–π `docker-compose.local.yml` ‚Üí –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ –¥–æ–¥–∞—Ç–æ–∫

---

## üõ†Ô∏è **–î–Ü–ê–ì–ù–û–°–¢–ò–ö–ê –ü–†–û–ë–õ–ï–ú**

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞"

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä —á–∏ —ñ—Å–Ω—É—î –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker ps -a | grep school-db

# –ó–∞–ø—É—Å—Ç–∏ –±–∞–∑—É –¥–∞–Ω–∏—Ö
docker start school-db

# –ü–µ—Ä–µ–≤—ñ—Ä —â–æ –∑–∞–ø—É—Å—Ç–∏–ª–∞—Å—è
docker ps | grep school-db
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: "–ù–µ –º–æ–∂—É –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ –±–∞–∑–∏"

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
docker exec school-db psql -U school_user -d school_db -c "SELECT 1;"

# –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ª–æ–≥–∏ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
docker logs school-db
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: "Webapp –Ω–µ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è"

```bash
# –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ª–æ–≥–∏
docker-compose -f docker-compose.local.yml logs webapp

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏
docker-compose -f docker-compose.local.yml restart webapp
```

### –ü—Ä–æ–±–ª–µ–º–∞ 4: "Telegram –±–æ—Ç –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—É—î"

```bash
# –ó—É–ø–∏–Ω–∏ dispatcher
docker-compose -f docker-compose.local.yml stop dispatcher

# –ü–æ–¥–∏–≤–∏—Å—å –ª–æ–≥–∏
docker-compose -f docker-compose.local.yml logs dispatcher
```

**–ü—Ä–∏–º—ñ—Ç–∫–∞:** –Ø–∫—â–æ –±–æ—Ç –≤–∂–µ –ø—Ä–∞—Ü—é—î –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ, –ª–æ–∫–∞–ª—å–Ω–∏–π dispatcher –º–æ–∂–µ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—É–≤–∞—Ç–∏.

---

## ‚ö†Ô∏è **–í–ê–ñ–õ–ò–í–Ü –ü–†–ê–í–ò–õ–ê –ë–ï–ó–ü–ï–ö–ò**

### ‚úÖ –©–û –ú–û–ñ–ù–ê –†–û–ë–ò–¢–ò:

- ‚úÖ –ó–∞–ø—É—Å–∫–∞—Ç–∏ —ñ –∑—É–ø–∏–Ω—è—Ç–∏ –¥–æ–¥–∞—Ç–æ–∫ (`webapp`, `dispatcher`)
- ‚úÖ –ü–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ –ª–æ–≥–∏
- ‚úÖ –¢–µ—Å—Ç—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª —á–µ—Ä–µ–∑ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- ‚úÖ –î–æ–¥–∞–≤–∞—Ç–∏/—Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤, –≤—á–∏—Ç–µ–ª—ñ–≤, —Ä–æ–∑–∫–ª–∞–¥–∏
- ‚úÖ –ü—Ä–æ–≤–æ–¥–∏—Ç–∏ —É—Ä–æ–∫–∏ —á–µ—Ä–µ–∑ Telegram

### ‚ùå –©–û –ù–ï –ú–û–ñ–ù–ê –†–û–ë–ò–¢–ò:

- ‚ùå **–ù–ï** –∑—É–ø–∏–Ω—è–π –±–∞–∑—É –¥–∞–Ω–∏—Ö `school-db` (—Ç–∞–º —Ü—ñ–Ω–Ω—ñ –¥–∞–Ω—ñ!)
- ‚ùå **–ù–ï** –≤–∏–¥–∞–ª—è–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä `school-db`
- ‚ùå **–ù–ï** –∑–∞–ø—É—Å–∫–∞–π `docker-compose down` –±–µ–∑ `-f docker-compose.local.yml`
- ‚ùå **–ù–ï** –∑–º—ñ–Ω—é–π –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö –≤—Ä—É—á–Ω—É

---

## üîÑ **–û–ù–û–í–õ–ï–ù–ù–Ø –î–û–î–ê–¢–ö–£**

–Ø–∫—â–æ –∑–º—ñ–Ω–∏–≤ –∫–æ–¥:

```bash
# 1. –ó—É–ø–∏–Ω–∏ –¥–æ–¥–∞—Ç–æ–∫
./stop_local.sh

# 2. –ü–µ—Ä–µ–∑–±–µ—Ä–∏ –æ–±—Ä–∞–∑–∏
docker-compose -f docker-compose.local.yml build

# 3. –ó–∞–ø—É—Å—Ç–∏ –∑–Ω–æ–≤—É
./start_local.sh
```

---

## üìö **–î–û–î–ê–¢–ö–û–í–Ü –ö–û–ú–ê–ù–î–ò**

### –í–∏–∫–æ–Ω–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó –±–∞–∑–∏ –¥–∞–Ω–∏—Ö:

```bash
docker-compose -f docker-compose.local.yml exec webapp alembic upgrade head
```

### –í—ñ–¥–∫—Ä–∏—Ç–∏ shell –≤ webapp –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ:

```bash
docker-compose -f docker-compose.local.yml exec webapp bash
```

### –í—ñ–¥–∫—Ä–∏—Ç–∏ psql (–±–∞–∑–∞ –¥–∞–Ω–∏—Ö):

```bash
docker exec -it school-db psql -U school_user -d school_db
```

---

## ‚úÖ **–ì–û–¢–û–í–û!**

–¢–µ–ø–µ—Ä —É —Ç–µ–±–µ —î:
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω–∏–π –¥–æ–¥–∞—Ç–æ–∫, –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏–π –¥–æ —ñ—Å–Ω—É—é—á–æ—ó –ë–î
- ‚úÖ –ë–µ–∑–ø–µ—á–Ω–∏–π –∑–∞–ø—É—Å–∫ (–ë–î –Ω–µ –∑–∞—á—ñ–ø–∞—î—Ç—å—Å—è)
- ‚úÖ –ü—Ä–æ—Å—Ç—ñ —Å–∫—Ä–∏–ø—Ç–∏ –¥–ª—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è
- ‚úÖ –ü–æ–≤–Ω–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

**–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –≤ –±–µ–∑–ø–µ—Ü—ñ, –∞ —Ç–∏ –º–æ–∂–µ—à —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –¥–æ–¥–∞—Ç–æ–∫ –ª–æ–∫–∞–ª—å–Ω–æ! üéâ**


