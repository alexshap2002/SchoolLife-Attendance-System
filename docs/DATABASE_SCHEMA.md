# üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –°—Ö–µ–º–∏ –ë–∞–∑–∏ –î–∞–Ω–∏—Ö
## üè´ –°–∏—Å—Ç–µ–º–∞ –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –®–∫–æ–ª–æ—é –ñ–∏—Ç—Ç—è

---

**üìÖ –û—Å—Ç–∞–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:** 15 –≤–µ—Ä–µ—Å–Ω—è 2025  
**üìù –í–µ—Ä—Å—ñ—è —Å—Ö–µ–º–∏:** 2.0  
**üóÉÔ∏è –°–£–ë–î:** PostgreSQL 15+  

---

## üìã –ó–º—ñ—Å—Ç

1. [–û–≥–ª—è–¥ –°–∏—Å—Ç–µ–º–∏](#–æ–≥–ª—è–¥-—Å–∏—Å—Ç–µ–º–∏)
2. [–°—Ö–µ–º–∞ –¢–∞–±–ª–∏—Ü—å](#—Å—Ö–µ–º–∞-—Ç–∞–±–ª–∏—Ü—å)
3. [–ó–≤'—è–∑–∫–∏ –º—ñ–∂ –¢–∞–±–ª–∏—Ü—è–º–∏](#–∑–≤—è–∑–∫–∏-–º—ñ–∂-—Ç–∞–±–ª–∏—Ü—è–º–∏)
4. [–Ü–Ω–¥–µ–∫—Å–∏ —Ç–∞ –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è](#—ñ–Ω–¥–µ–∫—Å–∏-—Ç–∞-–æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è)
5. [Constraints —Ç–∞ –í–∞–ª—ñ–¥–∞—Ü—ñ—è](#constraints-—Ç–∞-–≤–∞–ª—ñ–¥–∞—Ü—ñ—è)
6. [–ú—ñ–≥—Ä–∞—Ü—ñ—ó —Ç–∞ –ó–º—ñ–Ω–∏](#–º—ñ–≥—Ä–∞—Ü—ñ—ó-—Ç–∞-–∑–º—ñ–Ω–∏)
7. [API —Ç–∞ –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó](#api-—Ç–∞-—ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó)
8. [Backup —Ç–∞ –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥](#backup-—Ç–∞-–º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥)

---

## üéØ –û–≥–ª—è–¥ –°–∏—Å—Ç–µ–º–∏

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —à–∫–æ–ª–æ—é –ø—ñ–¥—Ç—Ä–∏–º—É—î:
- üë• **–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏** —Ç–∞ —ó—Ö –ø—ñ–ª—å–≥–∞–º–∏
- üë®‚Äçüè´ **–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≤—á–∏—Ç–µ–ª—è–º–∏** —Ç–∞ —ó—Ö –∑–∞—Ä–ø–ª–∞—Ç–∞–º–∏  
- üéØ **–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≥—É—Ä—Ç–∫–∞–º–∏** —Ç–∞ —Ä–æ–∑–∫–ª–∞–¥–∞–º–∏
- üìö **–û–±–ª—ñ–∫ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—Ö —É—Ä–æ–∫—ñ–≤** —Ç–∞ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–æ—Å—Ç—ñ
- ü§ñ **Telegram-–±–æ—Ç** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏—Ö —Å–ø–æ–≤—ñ—â–µ–Ω—å
- üí∞ **–°–∏—Å—Ç–µ–º–∞ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –∑–∞—Ä–ø–ª–∞—Ç**

---

## üìä –°—Ö–µ–º–∞ –¢–∞–±–ª–∏—Ü—å

### üë• –°—Ç—É–¥–µ–Ω—Ç–∏ (`students`)

–û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —É—á–Ω—ñ–≤ —à–∫–æ–ª–∏.

```sql
CREATE TABLE students (
    id SERIAL PRIMARY KEY,
    first_name VARCHAR(100) NOT NULL,
    last_name VARCHAR(100) NOT NULL,
    birth_date DATE,
    age INTEGER,
    grade VARCHAR(20),
    phone_child VARCHAR(20),
    location VARCHAR(100),
    address TEXT,
    
    -- üë®‚Äçüë©‚Äçüëß‚Äçüë¶ –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –±–∞—Ç—å–∫—ñ–≤ (–ú–Ü–ì–†–û–í–ê–ù–û)
    parent_name VARCHAR(200),          -- DEPRECATED: –±—É–¥–µ –≤–∏–¥–∞–ª–µ–Ω–æ
    father_name VARCHAR(200),          -- NEW: –ü–Ü–ë –±–∞—Ç—å–∫–∞  
    mother_name VARCHAR(200),          -- NEW: –ü–Ü–ë –º–∞—Ç–µ—Ä—ñ
    phone_mother VARCHAR(20),
    phone_father VARCHAR(20),
    
    -- üèòÔ∏è –î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è
    settlement_type VARCHAR(50),       -- —Ç–∏–ø –Ω–∞—Å–µ–ª–µ–Ω–æ–≥–æ –ø—É–Ω–∫—Ç—É
    benefit_other TEXT,                -- —ñ–Ω—à—ñ –ø—ñ–ª—å–≥–∏
    
    -- üîí –ü—ñ–ª—å–≥–∏ —Ç–∞ —Å–æ—Ü—ñ–∞–ª—å–Ω—ñ —Å—Ç–∞—Ç—É—Å–∏
    benefit_low_income BOOLEAN DEFAULT FALSE,
    benefit_large_family BOOLEAN DEFAULT FALSE, 
    benefit_military_family BOOLEAN DEFAULT FALSE,
    benefit_internally_displaced BOOLEAN DEFAULT FALSE,
    benefit_orphan BOOLEAN DEFAULT FALSE,
    benefit_disability BOOLEAN DEFAULT FALSE,
    benefit_social_risk BOOLEAN DEFAULT FALSE,
    
    -- üóÉÔ∏è –°–∏—Å—Ç–µ–º–Ω—ñ –ø–æ–ª—è
    benefits_json JSONB,               -- Legacy JSON –ø–æ–ª–µ
    raw_row_id INTEGER,                -- ID –∑ —ñ–º–ø–æ—Ä—Ç—É
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

**üîó –ó–≤'—è–∑–∫–∏:**
- `enrollments` (1:N) - –∑–∞–ø–∏—Å–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞ –Ω–∞ –≥—É—Ä—Ç–∫–∏
- `schedule_enrollments` (1:N) - –∑–∞–ø–∏—Å–∏ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ —Ä–æ–∑–∫–ª–∞–¥–∏  
- `attendance` (1:N) - –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω—ñ—Å—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞

**üìä –Ü–Ω–¥–µ–∫—Å–∏:**
- `idx_students_name_lower` - –ø–æ—à—É–∫ –∑–∞ —ñ–º'—è–º (—Ä–µ–≥—ñ—Å—Ç—Ä–æ–Ω–µ–∑–∞–ª–µ–∂–Ω–∏–π)
- `idx_students_location` - —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∑–∞ –ª–æ–∫–∞—Ü—ñ—î—é

---

### üë®‚Äçüè´ –í—á–∏—Ç–µ–ª—ñ (`teachers`)

–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –ø–µ–¥–∞–≥–æ–≥—ñ—á–Ω–∏–π —Å–∫–ª–∞–¥.

```sql
CREATE TABLE teachers (
    id SERIAL PRIMARY KEY,
    full_name VARCHAR(200) NOT NULL,
    email VARCHAR(100) UNIQUE,
    phone VARCHAR(20),
    
    -- ü§ñ Telegram —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è
    tg_chat_id BIGINT UNIQUE,          -- Telegram Chat ID
    
    -- üè¢ –°—Ç–∞—Ç—É—Å
    active BOOLEAN DEFAULT TRUE,
    
    -- üóÉÔ∏è –°–∏—Å—Ç–µ–º–Ω—ñ –ø–æ–ª—è  
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

**üîó –ó–≤'—è–∑–∫–∏:**
- `lesson_events` (1:N) - –ø–æ–¥—ñ—ó —É—Ä–æ–∫—ñ–≤ –≤—á–∏—Ç–µ–ª—è
- `conducted_lessons` (1:N) - –ø—Ä–æ–≤–µ–¥–µ–Ω—ñ —É—Ä–æ–∫–∏
- `payroll` (1:N) - –Ω–∞—Ä–∞—Ö—É–≤–∞–Ω–Ω—è –∑–∞—Ä–ø–ª–∞—Ç–∏
- `pay_rates` (1:N) - —Ç–∞—Ä–∏—Ñ–∏ –≤—á–∏—Ç–µ–ª—è

**üìä –Ü–Ω–¥–µ–∫—Å–∏:**
- `idx_teachers_name_lower` - –ø–æ—à—É–∫ –∑–∞ —ñ–º'—è–º
- `idx_teachers_tg_chat_id` - Telegram —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è
- `idx_teachers_active` - –∞–∫—Ç–∏–≤–Ω—ñ –≤—á–∏—Ç–µ–ª—ñ

---

### üéØ –ì—É—Ä—Ç–∫–∏ (`clubs`)

–ù–∞–≤—á–∞–ª—å–Ω—ñ –≥—É—Ä—Ç–∫–∏ —Ç–∞ —Å–µ–∫—Ü—ñ—ó.

```sql
CREATE TABLE clubs (
    id SERIAL PRIMARY KEY,
    name VARCHAR(200) NOT NULL,
    description TEXT,
    duration_min INTEGER,             -- —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –∑–∞–Ω—è—Ç—Ç—è –≤ —Ö–≤–∏–ª–∏–Ω–∞—Ö
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

**üîó –ó–≤'—è–∑–∫–∏:**
- `enrollments` (1:N) - –∑–∞–ø–∏—Å–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –Ω–∞ –≥—É—Ä—Ç–æ–∫
- `schedules` (1:N) - —Ä–æ–∑–∫–ª–∞–¥–∏ –≥—É—Ä—Ç–∫–∞
- `lesson_events` (1:N) - –ø–æ–¥—ñ—ó —É—Ä–æ–∫—ñ–≤
- `conducted_lessons` (1:N) - –ø—Ä–æ–≤–µ–¥–µ–Ω—ñ —É—Ä–æ–∫–∏

---

### üìÖ –†–æ–∑–∫–ª–∞–¥–∏ (`schedules`)

–†–æ–∑–∫–ª–∞–¥ –∑–∞–Ω—è—Ç—å –¥–ª—è –≥—É—Ä—Ç–∫—ñ–≤.

```sql
CREATE TABLE schedules (
    id SERIAL PRIMARY KEY,
    club_id INTEGER NOT NULL REFERENCES clubs(id),
    teacher_id INTEGER NOT NULL REFERENCES teachers(id),
    day_of_week INTEGER NOT NULL,     -- 0=–ü–æ–Ω–µ–¥—ñ–ª–æ–∫, 6=–ù–µ–¥—ñ–ª—è
    start_time TIME NOT NULL,
    end_time TIME NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

---

### üìù –ó–∞–ø–∏—Å–∏ –Ω–∞ –ì—É—Ä—Ç–∫–∏ (`enrollments`)

–ó–∞–ø–∏—Å–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –Ω–∞ –≥—É—Ä—Ç–∫–∏ (–∑–∞–≥–∞–ª—å–Ω—ñ).

```sql
CREATE TABLE enrollments (
    id SERIAL PRIMARY KEY,
    student_id INTEGER NOT NULL REFERENCES students(id),
    club_id INTEGER NOT NULL REFERENCES clubs(id),
    enrolled_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    
    UNIQUE(student_id, club_id)
);
```

**üìä –Ü–Ω–¥–µ–∫—Å–∏:**
- `idx_enrollments_club_student` - –ø–æ—à—É–∫ –∑–∞ –≥—É—Ä—Ç–∫–æ–º —Ç–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–º
- `idx_enrollments_student` - –≤—Å—ñ –≥—É—Ä—Ç–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞

---

### üìÖ –ó–∞–ø–∏—Å–∏ –Ω–∞ –†–æ–∑–∫–ª–∞–¥–∏ (`schedule_enrollments`)

–ó–∞–ø–∏—Å–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ —Ä–æ–∑–∫–ª–∞–¥–∏.

```sql
CREATE TABLE schedule_enrollments (
    id SERIAL PRIMARY KEY,
    student_id INTEGER NOT NULL REFERENCES students(id),
    schedule_id INTEGER NOT NULL REFERENCES schedules(id),
    enrolled_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    
    UNIQUE(student_id, schedule_id)
);
```

**üìä –Ü–Ω–¥–µ–∫—Å–∏:**
- `idx_schedule_enrollments_schedule` - —Å—Ç—É–¥–µ–Ω—Ç–∏ —Ä–æ–∑–∫–ª–∞–¥—É
- `idx_schedule_enrollments_student` - —Ä–æ–∑–∫–ª–∞–¥–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞

---

### üìö –ü–æ–¥—ñ—ó –£—Ä–æ–∫—ñ–≤ (`lesson_events`)

–ó–∞–ø–ª–∞–Ω–æ–≤–∞–Ω—ñ —Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω—ñ —É—Ä–æ–∫–∏.

```sql
CREATE TABLE lesson_events (
    id SERIAL PRIMARY KEY,
    
    -- üîó –ó–≤'—è–∑–∫–∏ (schedule_id –º–æ–∂–µ –±—É—Ç–∏ NULL –¥–ª—è manual lessons)
    schedule_id INTEGER REFERENCES schedules(id),  -- ‚úÖ NULLABLE –ø—ñ—Å–ª—è –º—ñ–≥—Ä–∞—Ü—ñ—ó
    teacher_id INTEGER NOT NULL REFERENCES teachers(id),
    club_id INTEGER NOT NULL REFERENCES clubs(id),
    
    -- üìÖ –î–∞—Ç–∞ —Ç–∞ —á–∞—Å
    date DATE NOT NULL,
    start_at TIMESTAMP WITH TIME ZONE,
    
    -- üìä –°—Ç–∞—Ç—É—Å (ENUM)
    status lessoneventstatus NOT NULL DEFAULT 'PLANNED',
    -- –ú–æ–∂–ª–∏–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è: PLANNED, SENT, COMPLETED, SKIPPED
    
    -- ü§ñ Telegram —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è
    teacher_chat_id BIGINT,
    notify_at TIMESTAMP WITH TIME ZONE,
    sent_at TIMESTAMP WITH TIME ZONE,
    send_attempts INTEGER DEFAULT 0,
    last_error TEXT,
    
    -- üóÉÔ∏è –ú–µ—Ç–∞–¥–∞–Ω—ñ
    idempotency_key VARCHAR(255),
    payload JSONB,
    
    -- üóÉÔ∏è –°–∏—Å—Ç–µ–º–Ω—ñ –ø–æ–ª—è
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    completed_at TIMESTAMP WITH TIME ZONE
);
```

**üìä –Ü–Ω–¥–µ–∫—Å–∏:**
- `idx_lesson_events_date_status` - —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∑–∞ –¥–∞—Ç–æ—é —Ç–∞ —Å—Ç–∞—Ç—É—Å–æ–º
- `idx_lesson_events_teacher_date` - —É—Ä–æ–∫–∏ –≤—á–∏—Ç–µ–ª—è –∑–∞ –¥–∞—Ç–æ—é
- `idx_lesson_events_club_date` - —É—Ä–æ–∫–∏ –≥—É—Ä—Ç–∫–∞ –∑–∞ –¥–∞—Ç–æ—é
- `idx_lesson_events_notify_at` - –Ω–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –¥–ª—è –æ–±—Ä–æ–±–∫–∏
- `idx_lesson_events_composite` - –∫–æ–º–ø–æ–∑–∏—Ç–Ω–∏–π —ñ–Ω–¥–µ–∫—Å

---

### ‚úÖ –í—ñ–¥–≤—ñ–¥—É–≤–∞–Ω—ñ—Å—Ç—å (`attendance`)

–û–±–ª—ñ–∫ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–æ—Å—Ç—ñ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤.

```sql
CREATE TABLE attendance (
    id SERIAL PRIMARY KEY,
    lesson_event_id INTEGER NOT NULL REFERENCES lesson_events(id),
    student_id INTEGER NOT NULL REFERENCES students(id),
    
    -- üìä –°—Ç–∞—Ç—É—Å –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–æ—Å—Ç—ñ (ENUM)
    status attendancestatus NOT NULL,
    -- –ú–æ–∂–ª–∏–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è: PRESENT, ABSENT
    
    -- üóÉÔ∏è –ú–µ—Ç–∞–¥–∞–Ω—ñ
    marked_by BIGINT,                 -- Telegram Chat ID —Ç–æ–≥–æ, —Ö—Ç–æ –≤—ñ–¥–º—ñ—Ç–∏–≤
    marked_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    
    UNIQUE(lesson_event_id, student_id)
);
```

**üìä –Ü–Ω–¥–µ–∫—Å–∏:**
- `idx_attendance_student_status` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç—É–¥–µ–Ω—Ç–∞—Ö
- `idx_attendance_lesson_event` - –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω—ñ—Å—Ç—å —É—Ä–æ–∫—É

---

### üìã –ü—Ä–æ–≤–µ–¥–µ–Ω—ñ –£—Ä–æ–∫–∏ (`conducted_lessons`)

–ü—ñ–¥—Å—É–º–∫–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—Ö –∑–∞–Ω—è—Ç—å.

```sql
CREATE TABLE conducted_lessons (
    id SERIAL PRIMARY KEY,
    
    -- üîó –ó–≤'—è–∑–∫–∏
    teacher_id INTEGER NOT NULL REFERENCES teachers(id),
    club_id INTEGER NOT NULL REFERENCES clubs(id),
    lesson_event_id INTEGER REFERENCES lesson_events(id),
    
    -- üìÖ –î–∞—Ç–∞ —Ç–∞ —á–∞—Å
    lesson_date TIMESTAMP WITH TIME ZONE NOT NULL,
    lesson_duration_minutes INTEGER,
    
    -- üë• –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–æ—Å—Ç—ñ
    total_students INTEGER NOT NULL DEFAULT 0,
    present_students INTEGER NOT NULL DEFAULT 0,
    absent_students INTEGER NOT NULL DEFAULT 0,
    
    -- üìä –û–±—á–∏—Å–ª—é–≤–∞–Ω—ñ –ø–æ–ª—è
    attendance_rate DECIMAL(5,2) GENERATED ALWAYS AS (
        CASE 
            WHEN total_students > 0 
            THEN (present_students::decimal / total_students * 100)
            ELSE 0 
        END
    ) STORED,
    
    -- üìù –î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è
    notes TEXT,
    lesson_topic VARCHAR(500),
    
    -- üí∞ –ó–∞—Ä–ø–ª–∞—Ç–∞
    is_salary_calculated BOOLEAN DEFAULT FALSE,
    is_valid_for_salary BOOLEAN GENERATED ALWAYS AS (present_students > 0) STORED,
    
    -- üóÉÔ∏è –°–∏—Å—Ç–µ–º–Ω—ñ –ø–æ–ª—è
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

**üìä –Ü–Ω–¥–µ–∫—Å–∏:**
- `idx_conducted_lessons_date` - —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∑–∞ –¥–∞—Ç–æ—é
- `idx_conducted_lessons_teacher_date` - —É—Ä–æ–∫–∏ –≤—á–∏—Ç–µ–ª—è
- `idx_conducted_lessons_club_date` - —É—Ä–æ–∫–∏ –≥—É—Ä—Ç–∫–∞

---

### üí∞ –¢–∞—Ä–∏—Ñ–∏ (`pay_rates`)

–¢–∞—Ä–∏—Ñ–∏ –æ–ø–ª–∞—Ç–∏ –¥–ª—è –≤—á–∏—Ç–µ–ª—ñ–≤.

```sql
CREATE TABLE pay_rates (
    id SERIAL PRIMARY KEY,
    teacher_id INTEGER NOT NULL REFERENCES teachers(id),
    rate_per_lesson DECIMAL(10,2) NOT NULL,
    effective_from DATE DEFAULT CURRENT_DATE,
    effective_to DATE,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

---

### üíµ –ó–∞—Ä–ø–ª–∞—Ç–∏ (`payroll`)

–ù–∞—Ä–∞—Ö—É–≤–∞–Ω–Ω—è –∑–∞—Ä–ø–ª–∞—Ç –≤—á–∏—Ç–µ–ª—è–º.

```sql
CREATE TABLE payroll (
    id SERIAL PRIMARY KEY,
    teacher_id INTEGER NOT NULL REFERENCES teachers(id),
    lesson_event_id INTEGER REFERENCES lesson_events(id),
    amount_decimal DECIMAL(10,2) NOT NULL,
    
    -- üìä –°—Ç–∞—Ç—É—Å
    status VARCHAR(20) DEFAULT 'CALCULATED',  -- CALCULATED, APPROVED, PAID
    
    -- üìÖ –î–∞—Ç–∏
    period_start DATE,
    period_end DATE,
    
    -- üóÉÔ∏è –ú–µ—Ç–∞–¥–∞–Ω—ñ
    notes TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

**üìä –Ü–Ω–¥–µ–∫—Å–∏:**
- `idx_payroll_teacher_created` - –∑–∞—Ä–ø–ª–∞—Ç–∏ –≤—á–∏—Ç–µ–ª—è –∑–∞ –ø–µ—Ä—ñ–æ–¥–æ–º
- `idx_payroll_created_month` - –º—ñ—Å—è—á–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

---

## üîó –ó–≤'—è–∑–∫–∏ –º—ñ–∂ –¢–∞–±–ª–∏—Ü—è–º–∏

```mermaid
erDiagram
    students ||--o{ enrollments : "–∑–∞–ø–∏—Å—É—î—Ç—å—Å—è"
    students ||--o{ schedule_enrollments : "–∑–∞–ø–∏—Å—É—î—Ç—å—Å—è" 
    students ||--o{ attendance : "–≤—ñ–¥–≤—ñ–¥—É—î"
    
    teachers ||--o{ schedules : "–≤–∏–∫–ª–∞–¥–∞—î"
    teachers ||--o{ lesson_events : "–ø—Ä–æ–≤–æ–¥–∏—Ç—å"
    teachers ||--o{ conducted_lessons : "–ø—Ä–æ–≤–æ–¥–∏—Ç—å"
    teachers ||--o{ pay_rates : "–º–∞—î —Ç–∞—Ä–∏—Ñ"
    teachers ||--o{ payroll : "–æ—Ç—Ä–∏–º—É—î –∑–∞—Ä–ø–ª–∞—Ç—É"
    
    clubs ||--o{ enrollments : "–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤"
    clubs ||--o{ schedules : "–º–∞—î —Ä–æ–∑–∫–ª–∞–¥–∏"
    clubs ||--o{ lesson_events : "–º–∞—î —É—Ä–æ–∫–∏"
    clubs ||--o{ conducted_lessons : "–º–∞—î –ø—Ä–æ–≤–µ–¥–µ–Ω—ñ —É—Ä–æ–∫–∏"
    
    schedules ||--o{ schedule_enrollments : "–º—ñ—Å—Ç–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤"
    schedules ||--o{ lesson_events : "–≥–µ–Ω–µ—Ä—É—î –ø–æ–¥—ñ—ó"
    
    lesson_events ||--o{ attendance : "–º–∞—î –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω—ñ—Å—Ç—å"
    lesson_events ||--o{ conducted_lessons : "—Å—Ç–≤–æ—Ä—é—î –ø—ñ–¥—Å—É–º–æ–∫"
    lesson_events ||--o{ payroll : "–≥–µ–Ω–µ—Ä—É—î –∑–∞—Ä–ø–ª–∞—Ç—É"
```

---

## ‚ö° –Ü–Ω–¥–µ–∫—Å–∏ —Ç–∞ –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è

### üéØ –û—Å–Ω–æ–≤–Ω—ñ –Ü–Ω–¥–µ–∫—Å–∏

```sql
-- –í—ñ–¥–≤—ñ–¥—É–≤–∞–Ω—ñ—Å—Ç—å (–Ω–∞–π—á–∞—Å—Ç—ñ—à—ñ –∑–∞–ø–∏—Ç–∏)
CREATE INDEX idx_attendance_student_status ON attendance (student_id, status);
CREATE INDEX idx_attendance_lesson_event ON attendance (lesson_event_id);

-- –£—Ä–æ–∫–∏ —Ç–∞ —Ä–æ–∑–∫–ª–∞–¥–∏
CREATE INDEX idx_lesson_events_date_status ON lesson_events (date, status);
CREATE INDEX idx_lesson_events_teacher_date ON lesson_events (teacher_id, date);
CREATE INDEX idx_lesson_events_club_date ON lesson_events (club_id, date);

-- –ó–∞–ø–∏—Å–∏ –Ω–∞ –≥—É—Ä—Ç–∫–∏
CREATE INDEX idx_enrollments_club_student ON enrollments (club_id, student_id);
CREATE INDEX idx_enrollments_student ON enrollments (student_id);

-- –ü–æ—à—É–∫ –∑–∞ —ñ–º–µ–Ω–∞–º–∏
CREATE INDEX idx_students_name_lower ON students (LOWER(first_name), LOWER(last_name));
CREATE INDEX idx_teachers_name_lower ON teachers (LOWER(full_name));

-- Telegram —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è
CREATE INDEX idx_teachers_tg_chat_id ON teachers (tg_chat_id) WHERE tg_chat_id IS NOT NULL;
CREATE INDEX idx_lesson_events_notify_at ON lesson_events (notify_at) WHERE notify_at IS NOT NULL;
```

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

–î–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –∑–∞–ø–∏—Ç—ñ–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ:
```sql
ANALYZE;  -- –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ç–∞–±–ª–∏—Ü—å
EXPLAIN (ANALYZE, BUFFERS) SELECT ...;  -- –ê–Ω–∞–ª—ñ–∑ –ø–ª–∞–Ω—ñ–≤ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
```

---

## üîí Constraints —Ç–∞ –í–∞–ª—ñ–¥–∞—Ü—ñ—è

### ‚úÖ CHECK Constraints

```sql
-- –í—ñ–∫ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤
ALTER TABLE students ADD CONSTRAINT check_student_age_extended 
CHECK (age IS NULL OR (age >= 3 AND age <= 18));

-- –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —É—Ä–æ–∫—ñ–≤  
ALTER TABLE clubs ADD CONSTRAINT check_lesson_duration_reasonable
CHECK (duration_min IS NULL OR (duration_min >= 30 AND duration_min <= 300));

-- –ü–æ–∑–∏—Ç–∏–≤–Ω—ñ —Å—É–º–∏ –∑–∞—Ä–ø–ª–∞—Ç
ALTER TABLE payroll ADD CONSTRAINT check_positive_amounts 
CHECK (amount_decimal > 0);

ALTER TABLE pay_rates ADD CONSTRAINT check_pay_rate_positive 
CHECK (rate_per_lesson > 0);

-- –ë–∞–∑–æ–≤–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è —Ç–µ–ª–µ—Ñ–æ–Ω—ñ–≤
ALTER TABLE students ADD CONSTRAINT check_phone_basic_format 
CHECK (
    (phone_child IS NULL OR LENGTH(phone_child) >= 10) AND
    (phone_mother IS NULL OR LENGTH(phone_mother) >= 10) AND
    (phone_father IS NULL OR LENGTH(phone_father) >= 10)
);
```

### üîë –£–Ω—ñ–∫–∞–ª—å–Ω—ñ –û–±–º–µ–∂–µ–Ω–Ω—è

```sql
-- –û–¥–∏–Ω —Å—Ç—É–¥–µ–Ω—Ç –º–æ–∂–µ –±—É—Ç–∏ –∑–∞–ø–∏—Å–∞–Ω–∏–π –Ω–∞ –≥—É—Ä—Ç–æ–∫ —Ç—ñ–ª—å–∫–∏ –æ–¥–∏–Ω —Ä–∞–∑
UNIQUE(student_id, club_id) ON enrollments

-- –û–¥–∏–Ω —Å—Ç—É–¥–µ–Ω—Ç –º–æ–∂–µ –±—É—Ç–∏ –∑–∞–ø–∏—Å–∞–Ω–∏–π –Ω–∞ —Ä–æ–∑–∫–ª–∞–¥ —Ç—ñ–ª—å–∫–∏ –æ–¥–∏–Ω —Ä–∞–∑  
UNIQUE(student_id, schedule_id) ON schedule_enrollments

-- –û–¥–Ω–∞ –≤—ñ–¥–º—ñ—Ç–∫–∞ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–æ—Å—Ç—ñ –Ω–∞ —É—Ä–æ–∫ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞
UNIQUE(lesson_event_id, student_id) ON attendance

-- –£–Ω—ñ–∫–∞–ª—å–Ω—ñ Telegram Chat ID
UNIQUE(tg_chat_id) ON teachers
```

---

## üîÑ –ú—ñ–≥—Ä–∞—Ü—ñ—ó —Ç–∞ –ó–º—ñ–Ω–∏

### üìã –ö—Ä–∏—Ç–∏—á–Ω—ñ –ú—ñ–≥—Ä–∞—Ü—ñ—ó (2025-09-15)

#### 1Ô∏è‚É£ schedule_id ‚Üí nullable
```sql
-- –î–æ–∑–≤–æ–ª—è—î —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è manual lessons –±–µ–∑ –ø—Ä–∏–≤'—è–∑–∫–∏ –¥–æ —Ä–æ–∑–∫–ª–∞–¥—É
ALTER TABLE lesson_events ALTER COLUMN schedule_id DROP NOT NULL;
```

#### 2Ô∏è‚É£ parent_name ‚Üí father_name/mother_name  
```sql
-- –ú—ñ–≥—Ä–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö –∑ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—è –≤ –¥–≤–∞ –æ–∫—Ä–µ–º–∏—Ö
UPDATE students SET father_name = parent_name 
WHERE parent_name IS NOT NULL AND parent_name != '–ë–∞—Ç—å–∫–æ/–ú–∞—Ç–∏';

-- parent_name –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è —è–∫ DEPRECATED –ø–æ–ª–µ –¥–ª—è —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ
```

#### 3Ô∏è‚É£ –î–æ–¥–∞–Ω–Ω—è –ø—ñ–ª—å–≥ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤
```sql
-- –ù–æ–≤—ñ –±—É–ª–µ–≤—ñ –ø–æ–ª—è –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ —Å–æ—Ü—ñ–∞–ª—å–Ω–∏—Ö –ø—ñ–ª—å–≥
ALTER TABLE students ADD COLUMN benefit_internally_displaced BOOLEAN DEFAULT FALSE;
ALTER TABLE students ADD COLUMN benefit_disability BOOLEAN DEFAULT FALSE;
-- ... —ñ–Ω—à—ñ –ø–æ–ª—è –ø—ñ–ª—å–≥
```

### üìà –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

- ‚úÖ **20 –Ω–æ–≤–∏—Ö —ñ–Ω–¥–µ–∫—Å—ñ–≤** –¥–ª—è –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤
- ‚úÖ **CHECK constraints** –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö  
- ‚úÖ **GENERATED –∫–æ–ª–æ–Ω–∫–∏** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏—Ö —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤
- ‚úÖ **UNIQUE constraints** –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤

---

## üåê API —Ç–∞ –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó

### üì± Telegram Bot

–ë–æ—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î:
- `teachers.tg_chat_id` - –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
- `lesson_events.notify_at` - –¥–ª—è –ø–ª–∞–Ω—É–≤–∞–Ω–Ω—è –Ω–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ–π  
- `attendance` - –¥–ª—è –∑–±–æ—Ä—É –≤—ñ–¥–º—ñ—Ç–æ–∫ –≤—ñ–¥ –≤—á–∏—Ç–µ–ª—ñ–≤

### üîÑ Polling Worker

–°–∏—Å—Ç–µ–º–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î DB-driven –ø—ñ–¥—Ö—ñ–¥:
```sql
-- –ü–æ—à—É–∫ —É—Ä–æ–∫—ñ–≤ –¥–ª—è –Ω–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
SELECT * FROM lesson_events 
WHERE notify_at <= NOW() 
  AND status = 'PLANNED'
  AND teacher_chat_id IS NOT NULL;
```

### üìä Dashboard API

–û—Å–Ω–æ–≤–Ω—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏:
- `/api/dashboard/charts` - –¥–∞–Ω—ñ –¥–ª—è –¥—ñ–∞–≥—Ä–∞–º
- `/api/students` - —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏
- `/api/teachers` - —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≤—á–∏—Ç–µ–ª—è–º–∏  
- `/api/conducted_lessons` - –ø—Ä–æ–≤–µ–¥–µ–Ω—ñ —É—Ä–æ–∫–∏

---

## üíæ Backup —Ç–∞ –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

### üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π Backup

–©–æ–¥–µ–Ω–Ω–∏–π backup –æ 2:00:
```bash
# Custom format (–¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è)
pg_dump -Fc -f school_db_$(date +%Y%m%d).dump school_db

# SQL format (–¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É —Ç–∞ –º—ñ–≥—Ä–∞—Ü—ñ–π)  
pg_dump -f school_db_$(date +%Y%m%d).sql school_db
```

### üìä –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

–ö–æ–∂–Ω—ñ 15 —Ö–≤–∏–ª–∏–Ω –∑–±–∏—Ä–∞—é—Ç—å—Å—è –º–µ—Ç—Ä–∏–∫–∏:
- –†–æ–∑–º—ñ—Ä –ë–î —Ç–∞ —Ç–∞–±–ª–∏—Ü—å
- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø—ñ–¥–∫–ª—é—á–µ–Ω—å
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–∏—Ç—ñ–≤
- –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è
- –°–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –º–µ—Ç—Ä–∏–∫–∏ —à–∫–æ–ª–∏ (—Å—Ç—É–¥–µ–Ω—Ç–∏, —É—Ä–æ–∫–∏, –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω—ñ—Å—Ç—å)

### üö® –ê–ª–µ—Ä—Ç–∏

–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ñ –∞–ª–µ—Ä—Ç–∏:
- –†–æ–∑–º—ñ—Ä –ë–î > 1GB
- –ê–∫—Ç–∏–≤–Ω–∏—Ö –ø—ñ–¥–∫–ª—é—á–µ–Ω—å > 50  
- –¢—Ä–∏–≤–∞–ª—ñ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è > 30—Å–µ–∫
- –ü–æ–º–∏–ª–∫–∏ backup
- –ù–∏–∑—å–∫–∞ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω—ñ—Å—Ç—å < 70%

---

## üìù –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–∞ –ü—Ä–∏–∫–ª–∞–¥–∏

### üîç –ö–æ—Ä–∏—Å–Ω—ñ –ó–∞–ø–∏—Ç–∏

#### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–æ—Å—Ç—ñ –ø–æ –≥—É—Ä—Ç–∫–∞—Ö
```sql
SELECT 
    c.name as club_name,
    COUNT(cl.id) as total_lessons,
    SUM(cl.present_students) as total_present,
    ROUND(AVG(cl.attendance_rate), 2) as avg_attendance_rate
FROM clubs c
LEFT JOIN conducted_lessons cl ON c.id = cl.club_id
WHERE cl.lesson_date >= CURRENT_DATE - INTERVAL '30 days'
GROUP BY c.id, c.name
ORDER BY avg_attendance_rate DESC;
```

#### –¢–æ–ø-10 –Ω–∞–π–∞–∫—Ç–∏–≤–Ω—ñ—à–∏—Ö —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤
```sql
SELECT 
    s.first_name || ' ' || s.last_name as student_name,
    COUNT(a.id) as total_attendances,
    COUNT(DISTINCT cl.club_id) as clubs_count
FROM students s
JOIN attendance a ON s.id = a.student_id AND a.status = 'PRESENT'
JOIN lesson_events le ON a.lesson_event_id = le.id
JOIN conducted_lessons cl ON le.id = cl.lesson_event_id
WHERE cl.lesson_date >= CURRENT_DATE - INTERVAL '30 days'
GROUP BY s.id, s.first_name, s.last_name
ORDER BY total_attendances DESC
LIMIT 10;
```

#### –ó–∞—Ä–ø–ª–∞—Ç–∏ –≤—á–∏—Ç–µ–ª—ñ–≤ –∑–∞ –º—ñ—Å—è—Ü—å
```sql
SELECT 
    t.full_name,
    COUNT(p.id) as payments_count,
    SUM(p.amount_decimal) as total_salary,
    AVG(p.amount_decimal) as avg_payment
FROM teachers t
JOIN payroll p ON t.id = p.teacher_id
WHERE date_trunc('month', p.created_at) = date_trunc('month', CURRENT_DATE)
GROUP BY t.id, t.full_name
ORDER BY total_salary DESC;
```

### üõ†Ô∏è –ö–æ—Ä–∏—Å–Ω—ñ VIEW

```sql
-- –ê–Ω–∞–ª—ñ—Ç–∏–∫–∞ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤
CREATE VIEW student_analytics AS
SELECT 
    s.id,
    s.first_name || ' ' || s.last_name as full_name,
    s.age,
    s.grade,
    COUNT(e.id) as clubs_count,
    COUNT(a.id) as total_lessons,
    COUNT(CASE WHEN a.status = 'PRESENT' THEN 1 END) as present_count,
    ROUND(
        COUNT(CASE WHEN a.status = 'PRESENT' THEN 1 END)::decimal / 
        NULLIF(COUNT(a.id), 0) * 100, 2
    ) as attendance_percentage
FROM students s
LEFT JOIN enrollments e ON s.id = e.student_id
LEFT JOIN attendance a ON s.id = a.student_id
GROUP BY s.id, s.first_name, s.last_name, s.age, s.grade;
```

---

## üö® –í–∞–∂–ª–∏–≤—ñ –ù–æ—Ç–∞—Ç–∫–∏

### ‚ö†Ô∏è DEPRECATED –ü–æ–ª—è

- `students.parent_name` - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `father_name` —Ç–∞ `mother_name`
- `students.benefits_json` - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –æ–∫—Ä–µ–º—ñ `benefit_*` –ø–æ–ª—è

### üîß –ü–ª–∞–Ω–æ–≤—ñ –ó–º—ñ–Ω–∏

1. –í–∏–¥–∞–ª–µ–Ω–Ω—è `parent_name` –ø—ñ—Å–ª—è –ø–æ–≤–Ω–æ—ó –º—ñ–≥—Ä–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö
2. –î–æ–¥–∞–Ω–Ω—è email –Ω–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ–π –¥–ª—è –≤—á–∏—Ç–µ–ª—ñ–≤  
3. –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏ —Ç–∞—Ä–∏—Ñ—ñ–≤ (–ø–æ–≥–æ–¥–∏–Ω–Ω–∞ –æ–ø–ª–∞—Ç–∞, –±–æ–Ω—É—Å–∏)
4. –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ–º–∏ –ø–ª–∞—Ç—ñ–∂–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

### üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó

1. **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–Ω–æ–≤–ª—é–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:** `ANALYZE;`
2. **–ú–æ–Ω—ñ—Ç–æ—Ä—Ç–µ —Ä–æ–∑–º—ñ—Ä –ë–î** —Ç–∞ –ø–ª–∞–Ω—É–π—Ç–µ –∞—Ä—Ö—ñ–≤—É–≤–∞–Ω–Ω—è —Å—Ç–∞—Ä–∏—Ö –¥–∞–Ω–∏—Ö
3. **–¢–µ—Å—Ç—É–π—Ç–µ backup** –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ñ–π –ë–î
4. **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó** –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π
5. **–Ü–Ω–¥–µ–∫—Å—É–π—Ç–µ –Ω–æ–≤—ñ –∫–æ–ª–æ–Ω–∫–∏** —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ WHERE/ORDER BY

---

**üìû –ü—ñ–¥—Ç—Ä–∏–º–∫–∞:** –°–∏—Å—Ç–µ–º–∞ —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∞ –¥–ª—è –®–∫–æ–ª–∏ –ñ–∏—Ç—Ç—è, –ë—Ä—É—Å–∏–ª—ñ–≤  
**üìÖ –î–∞—Ç–∞:** –í–µ—Ä–µ—Å–µ–Ω—å 2025  
**üíª –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó:** PostgreSQL, FastAPI, Telegram Bot API
