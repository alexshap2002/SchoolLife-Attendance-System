# üè´ –®–∫–æ–ª–∞ –∂–∏—Ç—Ç—è - –°–∏—Å—Ç–µ–º–∞ –æ–±–ª—ñ–∫—É –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–æ—Å—Ç—ñ

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–æ–≥–æ –æ–±–ª—ñ–∫—É –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–æ—Å—Ç—ñ –¥–ª—è –¥–∏—Ç—è—á–æ—ó –ø—Ä–æ–≥—Ä–∞–º–∏ "–®–∫–æ–ª–∞ –∂–∏—Ç—Ç—è" –∑ Telegram –±–æ—Ç–æ–º, –≤–µ–±-–∞–¥–º—ñ–Ω–∫–æ—é —Ç–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—î—é –∑ Google Sheets.

## üöÄ –û—Å–Ω–æ–≤–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –æ–±–ª—ñ–∫ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–æ—Å—Ç—ñ** —á–µ—Ä–µ–∑ Telegram –±–æ—Ç
- **–í–µ–±-–∞–¥–º—ñ–Ω–∫–∞** –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —É—á–Ω—è–º–∏, –≤—á–∏—Ç–µ–ª—è–º–∏, –≥—É—Ä—Ç–∫–∞–º–∏
- **–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∑–∞—Ä–ø–ª–∞—Ç–∏** –≤—á–∏—Ç–µ–ª—ñ–≤ (–∑–∞ –∑–∞–Ω—è—Ç—Ç—è –∞–±–æ –∑–∞ –ø—Ä–∏—Å—É—Ç–Ω—ñ—Ö)
- **–ï–∫—Å–ø–æ—Ä—Ç –≤ Google Sheets** –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—é —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—î—é
- **–Ü–º–ø–æ—Ä—Ç —É—á–Ω—ñ–≤** –∑ XLSX/CSV —Ñ–∞–π–ª—ñ–≤ (—É–∫—Ä–∞—ó–Ω—Å—å–∫—ñ –Ω–∞–∑–≤–∏ –∫–æ–ª–æ–Ω–æ–∫)
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –Ω–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è** –≤—á–∏—Ç–µ–ª—è–º –ø—Ä–æ –Ω–µ–∑–±–µ—Ä–µ–∂–µ–Ω—É –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω—ñ—Å—Ç—å

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

- **Backend**: FastAPI + SQLAlchemy 2.0 (async) + PostgreSQL
- **Bot**: aiogram v3
- **Scheduler**: APScheduler –∑ —á–∞—Å–æ–≤–æ—é –∑–æ–Ω–æ—é Europe/Kyiv
- **Frontend**: Server-side rendering –∑ Jinja2 + Bootstrap
- **Deploy**: Docker + docker-compose + Caddy (HTTPS)
- **Export**: Google Sheets API

## üìã –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

### 1. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞

```bash
git clone <repository-url>
cd "TG bot School of life"
make setup
```

### 2. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

#### 2.1 Telegram Bot
1. –°—Ç–≤–æ—Ä—ñ—Ç—å –±–æ—Ç–∞ —á–µ—Ä–µ–∑ [@BotFather](https://t.me/botfather)
2. –û—Ç—Ä–∏–º–∞–π—Ç–µ —Ç–æ–∫–µ–Ω —ñ –¥–æ–¥–∞–π—Ç–µ –≤ `.env`:
```bash
TELEGRAM_BOT_TOKEN=your_bot_token_here
```

#### 2.2 Google Sheets
1. –°—Ç–≤–æ—Ä—ñ—Ç—å –ø—Ä–æ—î–∫—Ç –≤ [Google Cloud Console](https://console.cloud.google.com/)
2. –£–≤—ñ–º–∫–Ω—ñ—Ç—å Google Sheets API —Ç–∞ Google Drive API
3. –°—Ç–≤–æ—Ä—ñ—Ç—å Service Account —ñ –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ JSON –∫–ª—é—á
4. –ü–æ–º—ñ—Å—Ç—ñ—Ç—å —Ñ–∞–π–ª —è–∫ `creds/service_account.json`
5. –°—Ç–≤–æ—Ä—ñ—Ç—å Google Spreadsheet —ñ –ø–æ–¥—ñ–ª—ñ—Ç—å—Å—è –∑ email Service Account
6. –î–æ–¥–∞–π—Ç–µ ID —Ç–∞–±–ª–∏—Ü—ñ –≤ `.env`:
```bash
SHEETS_SPREADSHEET_ID=your_spreadsheet_id_here
```

#### 2.3 –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è .env
–í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ —Ñ–∞–π–ª `.env`:
```bash
# Environment
ENV=dev
TZ=Europe/Kyiv

# Database  
POSTGRES_DB=schoola
POSTGRES_USER=schoola
POSTGRES_PASSWORD=your_secure_password

# Security
SECRET_KEY=your_very_secure_secret_key_here

# Telegram Bot
TELEGRAM_BOT_TOKEN=your_bot_token

# Google Sheets
SHEETS_SPREADSHEET_ID=your_spreadsheet_id
GOOGLE_SERVICE_ACCOUNT_JSON_PATH=/app/creds/service_account.json

# Admin
ADMIN_EMAIL=admin@schoola.local
ADMIN_PASSWORD=your_admin_password
```

### 3. –ó–∞–ø—É—Å–∫

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å—ñ—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤
make run

# –ê–±–æ –æ–∫—Ä–µ–º–æ
docker compose up --build
```

### 4. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è

```bash
# –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó
make migrate

# –î–æ–¥–∞—Ç–∏ —Ç–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
make seed
```

## üìñ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å
–í—ñ–¥–∫—Ä–∏–π—Ç–µ http://localhost/admin/ —ñ —É–≤—ñ–π–¥—ñ—Ç—å –∑:
- Email: `admin@schoola.local` 
- –ü–∞—Ä–æ–ª—å: `admin123` (–∞–±–æ –≤–∞—à –∑ .env)

### API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
–î–æ—Å—Ç—É–ø–Ω–∞ –∑–∞ –∞–¥—Ä–µ—Å–æ—é: http://localhost/docs

### Telegram Bot
1. –í—á–∏—Ç–µ–ª—ñ –Ω–∞—Ç–∏—Å–∫–∞—é—Ç—å `/start` –¥–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó
2. –í —á–∞—Å –∑–∞–Ω—è—Ç—Ç—è –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –Ω–∞–¥—Å–∏–ª–∞—î —á–µ–∫-–ª–∏—Å—Ç
3. –í—á–∏—Ç–µ–ª—å –≤—ñ–¥–º—ñ—á–∞—î –ø—Ä–∏—Å—É—Ç–Ω—ñ—Ö —ñ –Ω–∞—Ç–∏—Å–∫–∞—î "–ó–±–µ—Ä–µ–≥—Ç–∏"
4. –ß–µ—Ä–µ–∑ 15 —Ö–≤–∏–ª–∏–Ω –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –Ω–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è, —è–∫—â–æ –Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–æ

## üìä –Ü–º–ø–æ—Ä—Ç –¥–∞–Ω–∏—Ö

### –§–æ—Ä–º–∞—Ç XLSX/CSV –¥–ª—è —É—á–Ω—ñ–≤
–ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –∫–æ–ª–æ–Ω–∫–∏ (—É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é):
- `–Ü–º'—è –¥–∏—Ç–∏–Ω–∏:` ‚Üí first_name
- `–ü—Ä—ñ–∑–≤–∏—â–µ –¥–∏—Ç–∏–Ω–∏:` ‚Üí last_name  
- `–î–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –¥–∏—Ç–∏–Ω–∏:` ‚Üí birth_date
- `–í—ñ–∫:` ‚Üí age
- `–ö–ª–∞—Å —É —à–∫–æ–ª—ñ:` ‚Üí grade
- `–¢–µ–ª–µ—Ñ–æ–Ω –¥–∏—Ç–∏–Ω–∏:` ‚Üí phone_child
- `–ú—ñ—Å—Ü–µ –ø—Ä–æ–∂–∏–≤–∞–Ω–Ω—è:` ‚Üí location
- `–ê–¥—Ä–µ—Å–∞ –ø—Ä–æ–∂–∏–≤–∞–Ω–Ω—è:` ‚Üí address
- `–ü–Ü–ë –±–∞—Ç—å–∫–∞/–º–∞—Ç–µ—Ä—ñ` ‚Üí parent_name
- `–¢–µ–ª–µ—Ñ–æ–Ω –º–∞—Ç–µ—Ä—ñ:` ‚Üí phone_mother
- `–¢–µ–ª–µ—Ñ–æ–Ω –±–∞—Ç—å–∫–∞:` ‚Üí phone_father
- `–Ø–∫—É –ø—ñ–ª—å–≥—É –≤–∏ –º–∞—î—Ç–µ:*` ‚Üí benefits_json

### –Ü–º–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ API
```bash
curl -X POST "http://localhost/api/import/xlsx" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "file=@students.xlsx"
```

## üîß –†–æ–∑—Ä–æ–±–∫–∞

### –ö–æ–º–∞–Ω–¥–∏ –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏

```bash
# –ü–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤
make logs

# –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –∫–æ–¥—É
make format

# –õ—ñ–Ω—Ç–∏–Ω–≥
make lint

# –¢–µ—Å—Ç–∏
make test

# –û–±–æ–ª–æ–Ω–∫–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ
make shell

# –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö
make db-shell

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –º—ñ–≥—Ä–∞—Ü—ñ—ó
make migrate-create

# –ë–µ–∫–∞–ø –ë–î
make backup-db

# –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ë–î
make restore-db FILE=backup.sql
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
app/
‚îú‚îÄ‚îÄ core/           # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è, –ë–î, –±–µ–∑–ø–µ–∫–∞
‚îú‚îÄ‚îÄ models/         # SQLAlchemy –º–æ–¥–µ–ª—ñ
‚îú‚îÄ‚îÄ api/           # FastAPI —Ä–æ—É—Ç–µ—Ä–∏
‚îú‚îÄ‚îÄ services/      # –ë—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞
‚îú‚îÄ‚îÄ bot/           # Telegram –±–æ—Ç
‚îú‚îÄ‚îÄ web/           # –í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îî‚îÄ‚îÄ main.py        # –ì–æ–ª–æ–≤–Ω–∏–π —Ñ–∞–π–ª

alembic/           # –ú—ñ–≥—Ä–∞—Ü—ñ—ó –ë–î
scripts/           # –î–æ–ø–æ–º—ñ–∂–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏
creds/            # –§–∞–π–ª–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
```

## üìà –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

### Health Check
```bash
curl http://localhost/health
```

### –õ–æ–≥–∏
```bash
# –í—Å—ñ —Å–µ—Ä–≤—ñ—Å–∏
docker compose logs -f

# –¢—ñ–ª—å–∫–∏ –¥–æ–¥–∞—Ç–æ–∫
docker compose logs -f app

# –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö
docker compose logs -f db
```

## üîí –ë–µ–∑–ø–µ–∫–∞

- JWT —Ç–æ–∫–µ–Ω–∏ –¥–ª—è API
- HTTPS —á–µ—Ä–µ–∑ Caddy
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤–ª–∞—Å–Ω–æ—Å—Ç—ñ –∑–∞–Ω—è—Ç—å –≤ –±–æ—Ç—ñ
- –ê—É–¥–∏—Ç –≤—Å—ñ—Ö –∑–º—ñ–Ω –≤ `audit_log`
- –ó–∞—Ö–∏—â–µ–Ω—ñ API –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏ (—Ç—ñ–ª—å–∫–∏ –¥–ª—è –∞–¥–º—ñ–Ω—ñ–≤)

## üêõ –£—Å—É–Ω–µ–Ω–Ω—è –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ë–æ—Ç –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ `TELEGRAM_BOT_TOKEN` –≤ `.env`
2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω–∏–π: `docker compose logs app`
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ –≤—á–∏—Ç–µ–ª—å –Ω–∞—Ç–∏—Å–Ω—É–≤ `/start`

### Google Sheets –Ω–µ –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è  
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ `service_account.json` –≤ `creds/`
2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ Service Account –º–∞—î –¥–æ—Å—Ç—É–ø –¥–æ —Ç–∞–±–ª–∏—Ü—ñ
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ `SHEETS_SPREADSHEET_ID`

### –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞–Ω
docker compose ps

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ –ë–î
docker compose restart db

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏
docker compose logs db
```

### –ü—Ä–æ–±–ª–µ–º–∏ –∑ –º—ñ–≥—Ä–∞—Ü—ñ—è–º–∏
```bash
# –°–∫–∏–Ω—É—Ç–∏ –ë–î —ñ –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó –∑–∞–Ω–æ–≤–æ
make clean
make run
make migrate
```

## üìù TODO / –ú–∞–π–±—É—Ç–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

- [ ] –ú–æ–±—ñ–ª—å–Ω–∏–π –¥–æ–¥–∞—Ç–æ–∫ –¥–ª—è –±–∞—Ç—å–∫—ñ–≤
- [ ] SMS –Ω–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- [ ] –†–æ–∑—à–∏—Ä–µ–Ω–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–æ—Å—Ç—ñ
- [ ] –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –ø–ª–∞—Ç—ñ–∂–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- [ ] –ë–∞–≥–∞—Ç–æ–º–æ–≤–Ω—ñ—Å—Ç—å (–∞–Ω–≥–ª—ñ–π—Å—å–∫–∞)
- [ ] –ï–∫—Å–ø–æ—Ä—Ç –∑–≤—ñ—Ç—ñ–≤ –≤ PDF

## ü§ù –í–Ω–µ—Å–æ–∫

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π
2. –°—Ç–≤–æ—Ä—ñ—Ç—å feature branch (`git checkout -b feature/amazing-feature`)
3. –ó—Ä–æ–±—ñ—Ç—å commit (`git commit -m 'Add amazing feature'`)
4. Push –≤ branch (`git push origin feature/amazing-feature`)
5. –°—Ç–≤–æ—Ä—ñ—Ç—å Pull Request

## üìÑ –õ—ñ—Ü–µ–Ω–∑—ñ—è

MIT License - –¥–µ—Ç–∞–ª—ñ –≤ —Ñ–∞–π–ª—ñ `LICENSE`

## ü§ñ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è Telegram –±–æ—Ç–∞

### –®–≤–∏–¥–∫–∏–π —Ç–µ—Å—Ç
```bash
# –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π —Å–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
./test_bot.sh

# –ê–±–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ lesson_event –≤—Ä—É—á–Ω—É
docker exec school-db psql -U school_user -d school_db -c "
INSERT INTO lesson_events (schedule_id, date, club_id, teacher_id, teacher_chat_id, status, start_at, notify_at, send_attempts) 
SELECT s.id, CURRENT_DATE, s.club_id, s.teacher_id, t.tg_chat_id, 'PLANNED', 
       NOW() + INTERVAL '5 minutes', NOW() + INTERVAL '1 minute', 0
FROM schedules s 
JOIN teachers t ON t.id = s.teacher_id
WHERE s.active = true AND t.tg_chat_id IS NOT NULL
LIMIT 1;"
```

### –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º
```bash
# –õ–æ–≥–∏ dispatcher
docker logs school-dispatcher --tail 20

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ lesson_events
docker exec school-db psql -U school_user -d school_db -c "
SELECT le.id, le.status, c.name 
FROM lesson_events le 
JOIN clubs c ON c.id = le.club_id 
WHERE le.date >= CURRENT_DATE 
ORDER BY le.notify_at DESC LIMIT 5;"

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ —Ç–∞ enrollments
docker exec school-db psql -U school_user -d school_db -c "
SELECT s.first_name, s.last_name, c.name 
FROM students s 
JOIN enrollments e ON s.id = e.student_id 
JOIN clubs c ON c.id = e.club_id;"
```

**üìñ –î–µ—Ç–∞–ª—å–Ω–∏–π –≥–∞–π–¥**: [TELEGRAM_BOT_TESTING_GUIDE.md](./TELEGRAM_BOT_TESTING_GUIDE.md)

## üêõ –û—Å–Ω–æ–≤–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏ —Ç–∞ —Ä—ñ—à–µ–Ω–Ω—è

### 1. –ë–æ—Ç –Ω–µ –Ω–∞–¥—Å–∏–ª–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏: `docker logs school-dispatcher --tail 20`
- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ lesson_events: –º–∞—î –±—É—Ç–∏ `status='PLANNED'` —Ç–∞ `notify_at` –≤ –º–∏–Ω—É–ª–æ–º—É
- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∞–∫—Ç–∏–≤–Ω—ñ —Ä–æ–∑–∫–ª–∞–¥–∏: `s.active = true`
- **–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ teacher_chat_id**: `SELECT id, teacher_chat_id FROM lesson_events WHERE teacher_chat_id IS NULL`

### 2. –ö–Ω–æ–ø–∫–∏ –Ω–µ –∑–º—ñ–Ω—é—é—Ç—å —Å—Ç–∞—Ç—É—Å
- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ constraint: `attendance_lesson_student_unique` –º–∞—î —ñ—Å–Ω—É–≤–∞—Ç–∏
- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ enrollments: —Å—Ç—É–¥–µ–Ω—Ç–∏ –º–∞—é—Ç—å –±—É—Ç–∏ –∑–∞–ø–∏—Å–∞–Ω—ñ –Ω–∞ –≥—É—Ä—Ç–æ–∫
- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —ñ–º–ø–æ—Ä—Ç–∏ –≤ dispatcher.py: `Enrollment` –º–∞—î –±—É—Ç–∏ —ñ–º–ø–æ—Ä—Ç–æ–≤–∞–Ω–∏–π

### 3. –ù–µ–º–∞—î —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ —É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—ñ
- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ enrollments: `SELECT * FROM enrollments WHERE club_id = X`
- –î–æ–¥–∞—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤: `INSERT INTO enrollments (student_id, club_id) VALUES (X, Y)`

### 4. Dispatcher –Ω–µ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker restart school-dispatcher

# –ü–æ–≤–Ω–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º–∏
docker-compose -f docker-compose.local.yml down
docker-compose -f docker-compose.local.yml up -d
```

## üí¨ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–î–ª—è –ø–∏—Ç–∞–Ω—å —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ —Å—Ç–≤–æ—Ä—ñ—Ç—å Issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó –∞–±–æ –∑–≤'—è–∂—ñ—Ç—å—Å—è –∑ –∫–æ–º–∞–Ω–¥–æ—é —Ä–æ–∑—Ä–æ–±–∫–∏.

---

**–®–∫–æ–ª–∞ –∂–∏—Ç—Ç—è** - –¥–æ–ø–æ–º–∞–≥–∞—î–º–æ –¥—ñ—Ç—è–º —Ä–æ—Å—Ç–∏ —ñ —Ä–æ–∑–≤–∏–≤–∞—Ç–∏—Å—è! üåü
